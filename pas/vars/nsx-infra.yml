---
nsxt_admin_username: admin
nsxt_admin_password: ((nsx_admin_password))
nsxt_manager: https://sc2-nsxmgr-01.caas.pez.pivotal.io

logical_switches:
- name: PAS-Infrastructure-LS
  transport_zone_name: tz-overlay
- name: PAS-Deployment-LS
  transport_zone_name: tz-overlay
- name: PAS-Services-LS
  transport_zone_name: tz-overlay
- name: PAS-DynSvcs-LS
  transport_zone_name: tz-overlay

t1_logical_routers:
- name: "PAS-Infrastructure-T1"
  t0_name: "T0-Router"
  edgecluster_name: ""
  downlinks:
    - logical_switch_name: "PAS-Infrastructure-LS"
      router_port_cidr: "192.168.1.1/24"
- name: "PAS-Deployment-T1"
  t0_name: T0-Router
  edgecluster_name: "edge-cluster-01"
  downlinks:
    - logical_switch_name: PAS-Deployment-LS
      router_port_cidr: 192.168.2.1/24
- name: "PAS-Services-T1"
  t0_name: T0-Router
  edgecluster_name: ""
  downlinks:
    - logical_switch_name: PAS-Services-LS
      router_port_cidr: 192.168.3.1/24
- name: PAS-DynSvcs-T1
  t0_name: T0-Router
  edgecluster_name: ""
  downlinks:
    - logical_switch_name: PAS-DynSvcs-LS
      router_port_cidr: 192.168.4.1/24

load_balancers:
- name: pas-lb  # Name of Load-Balancer
  t1_name: PAS-Deployment-T1 # T1 to attach LB to
  monitors:
  - name: pas-web-monitor
    port: 8080
    protocol: LbHttpMonitor
    url: /health
  - name: pas-tcp-monitor
    port: 80
    protocol: LbHttpMonitor
    url: /health
  - name: pas-ssh-monitor
    port: 2222
    protocol: LbTcpMonitor
    url: /
  server_pools:
  - name: pas-web-pool
    monitor_name: pas-web-monitor
    translation_mode: LbSnatAutoMap
  - name: pas-tcp-pool
    monitor_name: pas-tcp-monitor
    translation_mode: Transparent
  - name: pas-ssh-pool
    monitor_name: pas-ssh-monitor
    translation_mode: Transparent
  virtual_servers:  #Virtual servers to create, each will be attached to the LB
  - name: pas-web-vs
    pool_name: pas-web-pool
    port: 443
    virtual_ip: 10.193.39.243
  - name: pas-tcp-vs
    pool_name: pas-tcp-pool
    port: 5900
    virtual_ip: 10.193.39.243
  - name: pas-ssh-vs
    pool_name: pas-ssh-pool
    port: 2222
    virtual_ip: 10.193.39.243

t0_nat_rules:
# must have a name
- name: opsman-dnat # DNAT to reach Ops Mgr
  t0_name: T0-Router
  action: DNAT
  source: Any
  dest: 10.193.39.241
  trans: 192.168.1.10
  priority: 805
- name: director-dnat # DNAT to reach BOSH Direector
  t0_name: T0-Router
  action: DNAT
  source: Any
  dest: 10.193.39.242
  trans: 192.168.1.10
  priority: 805
- name: opsman-snat #SNAT for OpsMan to get out
  t0_name: T0-Router
  action: SNAT
  source: 192.168.1.10
  dest: Any
  trans: 10.193.39.241
  priority: 805
- name: PAS-snat # SNAT for infra network to reach DNS, vCenter, etc
  t0_name: T0-Router
  action: SNAT
  source: 192.168.0.0/22
  dest: Any
  trans: 10.193.39.249
  priority: 805
# - name: infra-snat-esxi # SNAT for infra to reach ESXi hosts
#   t0_name: T0-Router
#   action: SNAT
#   source: 10.16.21.0/24
#   dest: 192.168.97.0/24
#   trans: 192.168.105.4
#   priority: 805
# - name: deploy-snat-mgmt # SNAT for deployment network to reach DNS, NTP, etc
  t0_name: T0-Router
  action: SNAT
  source: 10.16.22.0/24
  dest: 192.168.100.0/24
  trans: 192.168.105.5
  priority: 805

ip_blocks:
- name: PAS-container-IP-Block
  cidr: 172.32.0.0/14
  description: "Networks for new Orgs are allocated from this block"

ip_pools:
- name: PAS-FLOATING-IP-POOL
  cidr: 10.193.39.0/24
  description: "IP pool that provides 1 public IP for each Cloud Foundry Org"
  gateway: 10.193.39.1
  range: 10.193.39.241-10.193.39.253
  dns_servers:
